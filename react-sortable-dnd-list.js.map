{"version":3,"file":"react-sortable-dnd-list.js","sources":["../modules/SortableList.js"],"sourcesContent":["function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _nonIterableRest(); }\n\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); }\n\nfunction _iterableToArrayLimit(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"] != null) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; }\n\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport React, { useState, useEffect, useCallback, useRef } from 'react';\nimport PropTypes from 'prop-types';\n/**\r\n * Demo:\r\n * https://codepen.io/catamphetamine/pen/qBWxEQX\r\n *\r\n * `itemComponent` receives properties:\r\n * `dragging: boolean` — Is `true` when some item is being dragged.\r\n * `dragged: boolean` — Is `true` when this item is being dragged.\r\n * `style: object` — The `style` that must be set on the item root element.\r\n */\n\nexport default function SortableList(_ref) {\n  var items = _ref.value,\n      onChange = _ref.onChange,\n      Component = _ref.component,\n      ItemComponent = _ref.itemComponent,\n      itemComponentProps = _ref.itemComponentProps,\n      dragHandleDataAttribute = _ref.dragHandleDataAttribute,\n      animationDuration = _ref.animationDuration,\n      animationEasing = _ref.animationEasing,\n      rest = _objectWithoutProperties(_ref, [\"value\", \"onChange\", \"component\", \"itemComponent\", \"itemComponentProps\", \"dragHandleDataAttribute\", \"animationDuration\", \"animationEasing\"]);\n\n  var list = useRef();\n\n  var _useState = useState(),\n      _useState2 = _slicedToArray(_useState, 2),\n      dragging = _useState2[0],\n      setDragging = _useState2[1];\n\n  var _useState3 = useState(),\n      _useState4 = _slicedToArray(_useState3, 2),\n      willEndDragging = _useState4[0],\n      setWillEndDragging = _useState4[1];\n\n  var touchId = useRef();\n  var dragMoveHandler = useRef();\n  var draggedItemPosition = useRef();\n  var itemShiftsY = useRef();\n  var itemsOrder = useRef();\n  var prevItems = useRef();\n\n  if (items !== prevItems.current) {\n    prevItems.current = items; // Reset items order.\n\n    itemsOrder.current = items.map(function (item, i) {\n      return i;\n    });\n  }\n\n  useEffect(function () {\n    // Don't know why is this here.\n    var onTouchMove = function onTouchMove() {};\n\n    window.addEventListener('touchmove', onTouchMove);\n    return function () {\n      window.removeEventListener('touchmove', onTouchMove);\n    };\n  }, []);\n  var onDragStart = useCallback(function (node, y, touch) {\n    if (dragging) {\n      return;\n    } // The list requires at least two items in order to be sortable.\n\n\n    if (items.length === 1) {\n      return;\n    }\n\n    var item = getItem(list.current, node, dragHandleDataAttribute);\n\n    if (!item) {\n      return;\n    }\n\n    var _item = _slicedToArray(item, 2),\n        itemNode = _item[0],\n        position = _item[1];\n\n    setDragging({\n      touch: touch,\n      initialPosition: position,\n      // Using `.getBoundingClientRect()` instead of `.offsetHeight`/`.offsetTop`\n      // because `.offsetXxx` values don't know how to work with fractional pixels.\n      // Fractional pixels (for example, `0.5`) are used on \"retina\" screens.\n      itemHeights: Array.prototype.map.call(list.current.childNodes, function (node) {\n        return node.getBoundingClientRect().height;\n      }),\n      itemSpacing: list.current.childNodes[1].getBoundingClientRect().top - list.current.childNodes[0].getBoundingClientRect().bottom,\n      itemTopOffset: itemNode.getBoundingClientRect().top - list.current.childNodes[0].getBoundingClientRect().top,\n      dragStartY: y\n    });\n    draggedItemPosition.current = {\n      previous: position,\n      \"new\": position,\n      shiftY: 0\n    };\n    itemShiftsY.current = items.map(function (_) {\n      return 0;\n    });\n  }, [dragging]);\n  var onMouseDown = useCallback(function (event) {\n    // Left mouse button only.\n    if (event.button !== 0) {\n      return;\n    }\n\n    onDragStart(event.target, event.pageY);\n  }, [onDragStart]);\n  var onTouchStart = useCallback(function (event) {\n    // Single touch only.\n    if (event.touches.length > 1) {\n      return;\n    }\n\n    var touch = event.changedTouches[0];\n    onDragStart(event.target, touch.pageY, touch.identifier);\n  }, [onDragStart]);\n  var onDragMove = useCallback(function (event) {\n    if (!dragging) {\n      return;\n    }\n\n    var y;\n\n    if (dragging.touch !== undefined) {\n      for (var _iterator = event.changedTouches, _isArray = Array.isArray(_iterator), _i2 = 0, _iterator = _isArray ? _iterator : _iterator[Symbol.iterator]();;) {\n        var _ref2;\n\n        if (_isArray) {\n          if (_i2 >= _iterator.length) break;\n          _ref2 = _iterator[_i2++];\n        } else {\n          _i2 = _iterator.next();\n          if (_i2.done) break;\n          _ref2 = _i2.value;\n        }\n\n        var touch = _ref2;\n\n        if (touch.identifier === dragging.touch) {\n          y = touch.pageY;\n          break;\n        }\n      }\n    } else {\n      y = event.pageY;\n    }\n\n    if (y === undefined) {\n      return;\n    }\n\n    event.preventDefault();\n    var movedY = y - dragging.dragStartY;\n    var draggedItemOffsetTop = dragging.itemTopOffset + movedY;\n    var position = getDraggedItemPosition(dragging.itemHeights, dragging.itemSpacing, draggedItemOffsetTop, dragging.initialPosition);\n    var draggedItemHeight = dragging.itemHeights[dragging.initialPosition]; // Update list items' positions.\n\n    itemShiftsY.current = items.map(function (_, j) {\n      if (j < dragging.initialPosition) {\n        if (j >= position) {\n          return draggedItemHeight + dragging.itemSpacing;\n        } else {\n          return 0;\n        }\n      } else if (j > dragging.initialPosition) {\n        if (j <= position) {\n          return -1 * (draggedItemHeight + dragging.itemSpacing);\n        } else {\n          return 0;\n        }\n      } else {\n        return movedY;\n      }\n    }); // Apply item shifts Y.\n\n    var i = 0;\n\n    while (i < items.length) {\n      list.current.childNodes[i].style.transform = \"translateY(\".concat(itemShiftsY.current[i], \"px)\");\n      i++;\n    }\n\n    draggedItemPosition.current = {\n      previous: dragging.initialPosition,\n      \"new\": position,\n      shiftY: getDraggedItemPositionY(dragging.itemHeights, dragging.itemSpacing, dragging.initialPosition, position) - getDraggedItemPositionY(dragging.itemHeights, dragging.itemSpacing, dragging.initialPosition, dragging.initialPosition)\n    };\n  }, [dragging]);\n  var onDragEnd = useCallback(function () {\n    setDragging();\n    setWillEndDragging(true);\n    var newItemsOrder = getNewItemsOrder(itemsOrder.current, draggedItemPosition.current.previous, draggedItemPosition.current[\"new\"]);\n    setTimeout(function () {\n      setWillEndDragging(false);\n      itemsOrder.current = newItemsOrder;\n      onChange(newItemsOrder.map(function (i) {\n        return items[i];\n      }));\n    }, animationDuration);\n  }, [itemsOrder.current]);\n  var onMouseUp = useCallback(function (event) {\n    if (event.which !== 1) {\n      return;\n    }\n\n    onDragEnd();\n  }, [onDragEnd]);\n  var onTouchEnd = useCallback(function (event) {\n    for (var _iterator2 = event.changedTouches, _isArray2 = Array.isArray(_iterator2), _i3 = 0, _iterator2 = _isArray2 ? _iterator2 : _iterator2[Symbol.iterator]();;) {\n      var _ref3;\n\n      if (_isArray2) {\n        if (_i3 >= _iterator2.length) break;\n        _ref3 = _iterator2[_i3++];\n      } else {\n        _i3 = _iterator2.next();\n        if (_i3.done) break;\n        _ref3 = _i3.value;\n      }\n\n      var touch = _ref3;\n\n      if (touch.identifier === touchId.current) {\n        onDragEnd();\n        return;\n      }\n    }\n  }, [onDragEnd]);\n  useEffect(function () {\n    if (dragging) {\n      dragMoveHandler.current = onDragMove;\n\n      if (dragging.touch !== undefined) {\n        touchId.current = dragging.touch;\n        window.addEventListener('touchmove', dragMoveHandler.current, {\n          passive: false\n        });\n        window.addEventListener('touchend', onTouchEnd);\n      } else {\n        window.addEventListener('mousemove', dragMoveHandler.current, {\n          passive: false\n        });\n        window.addEventListener('mouseup', onMouseUp);\n      }\n    } else {\n      if (touchId.current !== undefined) {\n        touchId.current = undefined;\n        window.removeEventListener('touchmove', dragMoveHandler.current, {\n          passive: false\n        });\n        window.removeEventListener('touchend', onTouchEnd);\n      } else {\n        window.removeEventListener('mousemove', dragMoveHandler.current, {\n          passive: false\n        });\n        window.removeEventListener('mouseup', onMouseUp);\n      }\n\n      dragMoveHandler.current = undefined;\n    }\n  }, [dragging]);\n  useEffect(function () {\n    if (willEndDragging) {\n      // Reset dragged item position.\n      list.current.childNodes[draggedItemPosition.current.previous].style.transform = \"translateY(\".concat(draggedItemPosition.current.shiftY, \"px)\");\n    }\n  }, [willEndDragging]);\n  return React.createElement(Component, _extends({}, rest, {\n    ref: list,\n    onTouchStart: onTouchStart,\n    onMouseDown: onMouseDown\n  }), itemsOrder.current.map(function (i, position) {\n    return React.createElement(ItemComponent, _extends({}, itemComponentProps, {\n      key: i,\n      dragging: dragging ? true : false,\n      dragged: dragging && dragging.initialPosition === position,\n      style: dragging || willEndDragging ? getItemStyle(position === draggedItemPosition.current.previous, itemShiftsY.current[position], willEndDragging, animationDuration, animationEasing) : TRANSFORM_NONE\n    }), items[i]);\n  }));\n}\nSortableList.propTypes = {\n  value: PropTypes.arrayOf(PropTypes.any).isRequired,\n  onChange: PropTypes.func.isRequired,\n  component: PropTypes.elementType.isRequired,\n  itemComponent: PropTypes.elementType.isRequired,\n  itemComponentProps: PropTypes.object,\n  animationDuration: PropTypes.number.isRequired,\n  animationEasing: PropTypes.string.isRequired\n};\nvar TRANSFORM_NONE = {\n  transform: 'none'\n};\n\nfunction getItemStyle(isDragged, shiftY, willEndDragging, animationDuration, animationEasing) {\n  var style = {\n    transition: \"all \".concat(animationDuration, \"ms \").concat(animationEasing)\n  };\n\n  if (isDragged) {\n    style.zIndex = 1;\n\n    if (!willEndDragging) {\n      style.transition = undefined;\n    }\n  } else {\n    style.transform = \"translateY(\".concat(shiftY, \"px)\");\n  }\n\n  return style;\n}\n\nvar ListComponent = React.forwardRef(function (_ref4, ref) {\n  var children = _ref4.children,\n      rest = _objectWithoutProperties(_ref4, [\"children\"]);\n\n  return React.createElement(\"div\", _extends({\n    ref: ref\n  }, rest), children);\n});\nSortableList.defaultProps = {\n  component: ListComponent,\n  animationDuration: 200,\n  animationEasing: 'ease-out' // Interactive elements aren't draggable.\n\n};\nvar IGNORE_CLICKS_INSIDE_TAGS = ['a', 'button', 'input', 'textarea', 'select'];\n/**\r\n * Returns the list item that has been clicked (along with its index).\r\n * @param {Element} list\r\n * @param {Element} node — The DOM Element that has been clicked.\r\n * @param {string} [dragHandleDataAttribute] — Drag handle data attribute.\r\n * @return {any[]} [result] — An array having shape `[item, i]`.\r\n */\n\nfunction getItem(list, node, dragHandleDataAttribute) {\n  var handle;\n  var childNode;\n\n  while (node) {\n    if (node === list) {\n      // Clicked outside of a handle.\n      if (dragHandleDataAttribute && !handle) {\n        return;\n      }\n\n      if (childNode) {\n        var i = 0;\n\n        while (i < node.childNodes.length) {\n          if (node.childNodes[i] === childNode) {\n            return [childNode, i];\n          }\n\n          i++;\n        }\n      }\n\n      break;\n    }\n\n    if (IGNORE_CLICKS_INSIDE_TAGS.indexOf(node.tagName.toLowerCase()) >= 0) {\n      return;\n    }\n\n    if (node.dataset[dragHandleDataAttribute]) {\n      handle = node;\n    }\n\n    childNode = node;\n    node = node.parentElement;\n  }\n}\n\nfunction getDraggedItemPosition(itemHeights, itemSpacing, draggedItemOffsetTop, initialPosition) {\n  var scanLineY = draggedItemOffsetTop + itemHeights[initialPosition] / 2 + itemSpacing / 2;\n  var y = 0;\n  var i = 0;\n  var subtractOwnPosition = 0;\n\n  while (i < itemHeights.length) {\n    y += itemHeights[i] + itemSpacing;\n\n    if (scanLineY <= y) {\n      return i;\n    }\n\n    i++;\n  }\n\n  return itemHeights.length - 1;\n}\n\nfunction getDraggedItemPositionY(itemHeights, itemSpacing, initialPosition, position) {\n  var top = 0;\n  var j = 0;\n\n  while (j < position) {\n    if (j === initialPosition) {\n      position++;\n    } else {\n      top += itemHeights[j] + itemSpacing;\n    }\n\n    j++;\n  }\n\n  return top;\n}\n\nfunction getNewItemsOrder(itemsOrder, fromPosition, toPosition) {\n  if (toPosition < fromPosition) {\n    return itemsOrder.slice(0, toPosition).concat(itemsOrder[fromPosition]).concat(itemsOrder.slice(toPosition, fromPosition)).concat(itemsOrder.slice(fromPosition + 1));\n  }\n\n  if (toPosition > fromPosition) {\n    return itemsOrder.slice(0, fromPosition).concat(itemsOrder.slice(fromPosition + 1, toPosition + 1)).concat(itemsOrder[fromPosition]).concat(itemsOrder.slice(toPosition + 1));\n  }\n\n  return itemsOrder.slice();\n}\n//# sourceMappingURL=SortableList.js.map"],"names":["_extends","Object","assign","target","i","arguments","length","source","key","prototype","hasOwnProperty","call","apply","this","_slicedToArray","arr","Array","isArray","_arrayWithHoles","_arr","_n","_d","_e","undefined","_s","_i","Symbol","iterator","next","done","push","value","err","_iterableToArrayLimit","TypeError","_nonIterableRest","_objectWithoutProperties","excluded","sourceKeys","keys","indexOf","_objectWithoutPropertiesLoose","getOwnPropertySymbols","sourceSymbolKeys","propertyIsEnumerable","SortableList","_ref","items","onChange","Component","component","ItemComponent","itemComponent","itemComponentProps","dragHandleDataAttribute","animationDuration","animationEasing","rest","list","useRef","_useState2","useState","dragging","setDragging","_useState4","willEndDragging","setWillEndDragging","touchId","dragMoveHandler","draggedItemPosition","itemShiftsY","itemsOrder","prevItems","current","map","item","useEffect","onTouchMove","window","addEventListener","removeEventListener","onDragStart","useCallback","node","y","touch","handle","childNode","childNodes","IGNORE_CLICKS_INSIDE_TAGS","tagName","toLowerCase","dataset","parentElement","getItem","_item","itemNode","position","initialPosition","itemHeights","getBoundingClientRect","height","itemSpacing","top","bottom","itemTopOffset","dragStartY","previous","new","shiftY","_","onMouseDown","event","button","pageY","onTouchStart","touches","changedTouches","identifier","onDragMove","_iterator","_isArray","_i2","_ref2","preventDefault","movedY","draggedItemOffsetTop","scanLineY","getDraggedItemPosition","draggedItemHeight","j","style","transform","concat","getDraggedItemPositionY","onDragEnd","newItemsOrder","fromPosition","toPosition","slice","getNewItemsOrder","setTimeout","onMouseUp","which","onTouchEnd","_iterator2","_isArray2","_i3","_ref3","passive","React","createElement","ref","dragged","getItemStyle","TRANSFORM_NONE","propTypes","PropTypes","arrayOf","any","isRequired","func","elementType","object","number","string","isDragged","transition","zIndex","ListComponent","forwardRef","_ref4","children","defaultProps"],"mappings":"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"}